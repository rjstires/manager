# Contributing to the Linode manager

Contributing to the Cloud Manager just involves sending a Pull Request.

The following buzzwords are involved in this project:

* [React.js](https://facebook.github.io/react/)
* [Redux](http://redux.js.org/)
* [Webpack](https://webpack.github.io/)
* ES6/ES7 (via [Babel](https://babeljs.io/))
* [SCSS](http://sass-lang.com)
* [Yarn](https://yarnpkg.com/)
* [WebdriverIO](https://webdriver.io/)

## Development

### Coding Style

The manager is written in ES6, with some ES7 in use as well. A general guideline
for the coding style is "imitate the code that's already there". When in doubt,
apply the [Airbnb style guide](https://github.com/airbnb/javascript) or just let
the linter do its thing.

### Importing and Structuring Dependencies

This project relies on a number of third-party dependencies. It us important that when importing those
dependencies you import only the necessary files. For example, if I needed to create an Observable
using RxJS I would import only Observable and the type of Observable I want to create. This keeps bundle
size down substantially.
```
/** Good */
import 'rxjs/add/observable/of';
import { Observable } from 'rxjs/Observable';

/** Bad */
import { Observable } from 'rxjs/Rx';
```
Additionally we order imports alphabetically within certain blocks. The blocks are;
```
/** Third Party Libs /**
import * as React from 'react';

/** Material UI Imports /**
import { WithStyles } from '@material-ui/core';
import Typography from '@material-ui/core/Typography';

/** Source Components /**
import { getLinodes } from 'src/services/linodes';

/** Relative Imports /**
import something from '../some/where/nearby';
```

### Testing
This project uses [Jest](https://facebook.github.io/jest/docs/en/api.html) for unit testing, snapshot testing, assertions, and mocking.

End-to-end tests are written using WebdriverIO.

For everything related to writing and running tests, [please see the documentation here.](TESTING.md)

## Git workflows

### Creating and Commiting to a New Branch

When creating a new feature, you should attempt to create a descriptive branch name. All branch names must be prefixed with `M3`, which stands for Manager 3, as this is the 3 iteration of this product.

For example `M3-my-cool-feature`

Once you have made all your changes, you can commit them.

We use [pre-commit](https://www.npmjs.com/package/pre-commit) to perform the following tasks:

1. Linting
2. Unit testing
3. Storybook end-to-end component testing
4. [Circular dependency check](https://github.com/pahen/madge)
5. Type Checking (as we're using TypeScript in the src code)

 If any fail the commit will be aborted. Address the reported issues, stage the changes, and attempt the commit again. This behaviour can be skipped using the
`--no-verify` flag, but we highly suggest you do _**not**_ use this flag

### Merge Conflicts

Merge conflicts happen, and when they do, we reccommend rebasing.

`git rebase -i develop` will allow you to interactively pick which commits you want to keep and then you can address the conflicts as they appear.

If you absolutely must merge the two branches, that is fine as we will squash all commits once the PR is merged.

### Deploying

We are following a CI/CD (continuous integration / continuous deployment) process for Cloud Manager. This means:
1. `develop` branch gets automatically deployed to out development environment
2. `testing` branch gets automatically deployed to out testing environment
3. `staging` branch gets automatically deployed to out staging environment
4. `master` branch gets automatically deployed to out production environment, AKA https://cloud.linode.com

This means we can deploy features quickly and efficiently.

When a new version of Cloud Manager is released, it must be accompanied by an update to [CHANGELOG.md](https://github.com/linode/manager/blob/master/CHANGELOG.md). See [Keepachangelog](http://keepachangelog.com/en/0.3.0/) for formatting details

#### What to Do When Releasing

Once your code from the `develop` branch has been merged into `testing`:

1. Pull down the latest `testing` branch locally
2. Run `yarn version --new-version vX.X.X` (replace the X's with the appropriate version number)
* this will apply the Git tags and update the version number in the `package.json`
3. [Generate the Changelog](#generating-the-changelog)
4. Review changelog and update manually if necessary
5. Stage and commit the version bump and changelog addition with the commit message,'vX.X.X'
6. Push up the changes to the `testing` branch with `git push origin testing`

### Generating the changelog
Get a Python 3 installation with pip. On a Mac

`brew install python` (Python 3 is now the default)

The changelog is generated by the script generate_changelog.py, this script can only run once a local release branch has been created.

The script accepts 3 parameters ${release version} ${release date yyyy.MM.dd} ${mangerRemote}

Does a git log diff of manager/master...HEAD, printing only the commit subject. Strips any reference to a jira ticket, and disregards any testing or automation ticket, and updates the CHANGELOG.md Added, Breaking, Fixed, Change based on keywords in the commit subject.

## Other Things

### Reporting Bugs

First, remember that this is a work in progress. Please don't report bugs for
features that aren't present, links that lead to 404's, buttons that don't
appear to do anything - these are all likely in-progress or not started
features. Instead, report bugs for regressions or problems with things that are
already implemented. Please search GitHub issues to see if
there's already a bug filed for your problem - if so, leave a comment
mentioning that you can reproduce it. Otherwise, go ahead and open an issue
with as much detail as you can provide (for example: node version, operating
system, browser, device, etc.). Thanks!

### References
- http://keepachangelog.com/en/0.3.0/
- https://help.github.com/articles/merging-a-pull-request/
- https://help.github.com/articles/about-pull-request-merges/
